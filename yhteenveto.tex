\chapter{Yhteenveto}
\label{ch:yhteenveto}
Tässä diplomityössä lähdettiin etsimään ratkaisua kuinka suunnitellaan ja toteutetaan yksittäinen komponentti osaksi isompaa järjestelmää, joka pystyisi jakaamaan tietoa sen muiden komponenttien kanssa. Lähtökohtana oli, että komponentti pystyisi tilaamaan tietoa sähköseman IED-laitteelta IEC 61850 -standardin mukaisesti. Lisäksi tieto täytyi saada jaettua järkevästi järjestelmän muille komponenteille, ilman että päädyttäisiin huonoihin teknisiin ratkaisuihin. Ennen diplomityön aloitusta tekijä oli yrityksessä toteuttanut demon komponentin toimivuudesta. Demo oli samalla tie oppia IEC 61850 -standardin toiminta ja perehtyä aiheeseen tarkemmin ennen oikeaa toteutusta. Tämä diplomityö keskittyi komponentin uuden version suunnitteluun ja toteutukseen käyttäen hyväksi demototeutuksen analyysia toiminnallisuudesta ja ongelmista. Lisäksi työn alussa asetettiin tutkimuskysymyksiä aiheeseen liittyen, joihin pyrittiin etsimään vastausta. Tutkimuskysymykset esiteltiin työn alussa kappaleessa \ref{ch:johdanto}.

Työssä etsittiin ratkaisua siihen, mitkä olisivat sopivat ohjelmiston arkkitehtuurimallit tämän kaltaisen ongelman ratkaisuun. Toteutuksessa päädyttiin käyttämään tilaaja-julkaisija arkkitehtuurimallia, missä toteutettu komponentti on julkaisija ja muut järjestelmän komponentit ovat tilaajia. Sähköaseman IED-laitteen ja komponentin välisen tiedonjaon täytyy automaattisesti noudattaa tilaaja-julkaisija arkkitehtuuria, koska IEC 61850 -stan\-dar\-dis\-sa määritetään niin. Tähän toteutusmalliin päädyttiin, koska järjestelmän muut komponentit tarvitsevat tietoa samalla periaatteella kuin ulkopuolinen ohjelma tarvitsee tietoa IED-laitteelta. Periaatteessa komponentti jatkaa IED-laitteen ja komponentin välistä tilaaja-julkaisija mallia ohjelmiston muille komponenteille välittäjäpalvelimen avulla. Lisäksi arkkitehtuurimalli on tarkoitettu ratkomaan tämän kaltaisia tilanteita, jossa toinen osapuoli tarvitsee tietoa halutessaan ja saa siitä tiedon kun uusi tieto on saatavilla. Näin saatiin aikaiseksi tiedon kulku järjestelmässä yhteen suuntaan ilman kyseenalaisia teknisiä toteutuksia. Demossa viestien jako oli toteutettu käyttäen tietokantaa tiedon välittäjänä, mikä ei ollut hyvä ratkaisu. Työn toteutuksessa viestien välitykseen valittiin RabbitMQ-välittäjäpalvelin. Tämän avulla järjestelmän muut komponentit pystyivät tilaamaan viestejä tarpeidensa mukaan ja saivat siitä huomautuksen kun uusi viesti saapui. Lisäksi palvelin tarjosi sisäisesti jonot tilaajille, jos ne eivät ehtineet prosessoida viestejä tarpeeksi nopeasti. RabbitMQ-välittäjäpalvelimena viestien välitykseen järjestelmän muille komponteille osoittautui järkeväksi ja toimivaksi vaihtoehdoksi.

Viestin muoto IED-laitteelta noudattaa IEC 61850 -standardin määrittämää muotoa. Toteutuksessa tämän viestin lukeminen hoidettiin libiec61850-kirjastolla. Jotta tieto saataisiin järkevästi järjestelmän muille komponenteille, täytyi se muuttaa johonkin muuhun helppokäyttöisempään muotoon. Jos järjestelmän osia toteutetaan eri tekniikoilla, viestin luku olisi mahdollista tekniikasta riippumatta. Toteutuksessa viesti päädyttiin muuttamaan JSON-muotoon. JSON on nykypäivänä paljon käytetty tiedonvälityksen muoto rajapinnoissa verkko-ohjelmointiin liittyen. Se on helppo luettava ihmiselle ja JSON-rakenteen lukemiselle löytyy toteutus monelle eri tekniikalle valmiiksi. Toteutuksessa valinta osoittautui hyväksi ja toimivaksi. Ohjelman tekemä JSON-muoto on nähtävissä liitteessä \ref{ch:report-json-format}.

Osa työtä oli demototeutuksen ongelmien analysointi ja sen selvittäminen kuinka ne vältettäisiin uudessa versiossa. Ongelmia oli mm. huono suorituskyky, muistivuoto ja toiminnan epävarmuus. Näitä ongelmia analysoitiin työssä syvällisesti kappaleessa \ref{ch:ongelmakohdat-ja-analysointi}. Suorituskykyä saatiin toteutuksessa paremmaksi valitsemalla suorituskykyisempi C-kieli. C on käännettävä kieli verrattuna Rubyn tulkattavaan kieleen. Lisäksi C voi hyödyntää käyttöjärjestelmän säikeitä ilman rajoituksia verrattuna Ruby-tulkin globaaliin lukitukseen (GIL). Muistivuoto saatiin korjattua huolellisella ohjelmoinnilla ja varmistamalla, että muisti varmasti vapautettiin kun sitä ei enää tarvittu. Toiminnan epävarmuus liittyi yhteyden aikakatkaisuihin, joka johtui taas huonosta suorituskyvystä. Tästä päästiin eroon kun kieli vaihdettiin nopeampaan. Työn toteutuksessa ei ollut demossa havaittavia ongelmia ja on osoittanut tuotannossa toimivaksi muun järjestelmän kanssa.

Tärkeimpänä puutteena toteutuksessa oli testiympäristön ja yksikkötestien puuttuminen. Testit olisivat tärkeät ohjelman jatkoa ja ylläpidettävyyttä ajatellen. Etenkin tulevaisuudessa kun siihen tullaan tekemään muutoksia, voidaan yksikkötesteillä varmistaa että ohjelma toimii ainakin niiltä osin halutulla tavalla. Tällä hetkellä muutoksien jälkeen ohjelma testata käsin. Testejä ei kirjoitettu tämän työn puitteissa, koska aika ei siihen riittänyt. Testit kuitenkin tullaan lisämään ohjelmaan myöhemmin osana muun järjestelmän testiajoa.

Diplomityössä tuloksena oli järjestelmään erillinen komponentti, joka kykeni tilaamaan viestit yhdeltä IED-laitteelta ja jakamaan tiedon järjestelmän muiden komponenttien kanssa. Kaikki ongelmat mitä demoversiossa oli, saatiin ratkaistua onnistuneesti. Ohjelmisto otettiin käyttöön muun järjestelmän kanssa tuotantoon. Voidaan sanoa, että työ pääsi asetettuihin tavoitteisiin ja onnistui niiltä osin hyvin. Lisäksi asetettuihin tutkimuskysymyksiin löydettiin vastaukset, jotka todettiin toimiviksi.